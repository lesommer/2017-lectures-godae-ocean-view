<!DOCTYPE html>
<html>
  <head>
    <title>Frontiers in ocean modelling</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <!-- This is template for http://remarkjs.com/ by Ole Petter Bang -->
    <!-- CSS modifcations by J. M. Lilly-->
    <!-- Adapted by J. Le Sommer-->

    <style type="text/css">
      @import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }

      .remark-slide-content h1 { font-size: 1.8em; color:#606060;font-weight: bold;letter-spacing:0.05em;margin-top:0em}
      .remark-slide-content h2 { font-size: 1.4em;color:#606060;font-weight: bold;letter-spacing:0.05em;margin-top:0em}
      .remark-slide-content  h3 { font-size: 1.2em;color:#606060;font-weight: bold;letter-spacing:0.05em;margin-top:0em}
      .remark-slide-content p,ol,ul { font-size: 1.0em; }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      .remark-fading { z-index: 9; }

      /* Thanks to http://www.partage-it.com/animez-vos-presentations-remark-js/  (in French) */
      .remark-slide-container {transition: opacity 0.5s ease-out;opacity: 0;}
      .remark-visible {transition: opacity 0.5s ease-out;opacity: 1;}

      /* Two-column layout */
      .left-column {
        width: 50%;
        float: left;
      }
      .right-column {
        width: 49%;
        float: right;
        padding-top: 0em;
        margin-top: 0em;
        text-align: left;
      }
      .footnote {
        position:absolute;
        bottom: 1em;
        left: 14em;
        font-size: 0.7em;
       }

      /* Some special classes */
      .title {font-size: 2.2em; color:#606060;font-weight:bold;letter-spacing:0.05em}
      .subtitle {font-size: 1.4em}
      .author {font-size: 1.2em; color:#606060;font-weight:bold;letter-spacing:0.02em}
      .coauthor {font-size: 1.0em; color:#606060;font-weight:bold;letter-spacing:0.02em}
      .institution {font-size: 1.0em;}
      .date {font-size: 1.0em;font-style: italic}

      .cite {font-size: 0.8em; color:#33AA99;font-style: italic}
      .strike {color:salmon;text-decoration:line-through}

      /*Set color scheme for links.*/
      a {text-decoration: none; color: #666666;text-align:center; width: 24%}
      /*Setting link properties is particular, do not change order below*/
      a:visited {color:#666666}
      a:hover {color:#33AA99}
      a:active, a#active {color:#FF9700;}
    </style>
  </head>
  <body>
    <textarea id="source">

class: middle,center
<!---
<img src="../figures/Logo-School-GODAE.png" width="50%" halign="left" />
--->

<img src="../figures/Logo-School-GODAE.png" width="50%" halign="left" />

&nbsp;


.title[New frontiers in ocean circulation modelling]
&nbsp;

&nbsp;
&nbsp;
&nbsp;

.author[[Julien Le Sommer](http://lesommer.github.io/)]

.institution[Institut des Géosciences de l'Environnement, CNRS, Grenoble, France]
&nbsp;

[julien.lesommer@univ-grenoble-alpes.fr](mailto:julien.lesommer@univ-grenoble-alpes.fr)
&nbsp;
&nbsp;

&nbsp;
&nbsp;
&nbsp;

<!---
<img src="../figures/smallIGE.png" width="10%" valign="left" />
<img src="../figures/logoCNRS.png" width="10%" halign="left" />
--->


<img src="../figures/affiliations-logo.png" width="30%" valign="left" />



---
class: left
#  About the lectures
&nbsp;

--
## Lecture #1 : Ocean circulations models : scope, usage and fundamentals.

 - Thursday: 11:45-12:30

## Lecture #2 : Representation of physical processes ocean circulation models

 - Saturday: 9:45-10:30 

## Lecture #3 : Towards data-driven, probabilistic ocean circulation models

 - Saturday: 11:45-12:30 

&nbsp;



--
## Slides of the lectures :
also here : [https://github.com/lesommer/2017-lectures-godae-ocean-view](https://github.com/lesommer/2017-lectures-godae-ocean-view)

## Book chapter (with Eric Chassignet):
also here : [https://github.com/lesommer/2017-book-chapter-godae-ocean-view](https://github.com/lesommer/2017-book-chapter-godae-ocean-view)



---
class: left
# Lecture #1 
## Ocean circulations models : scope, usage and fundamentals.



&nbsp;

### Topics covered

 - definition and scope of ocean circulation models

 - landscape of ocean circulation models.

 - range of usages of ocean circulation models

 - physical hypotheses and governing equations

 - boundaries, interfaces and forcings

 - discretizing the primitive equations

 - illustrations of current status/skill

---
class: left

# Lecture #1 
## Ocean circulations models : scope, usage and fundamentals.

*Ocean circulation models *


 - are based on **first principle physics**;

 - are used for a **wide range of applications**;

 - are a key **building block of operational oceanography**;

 - require **group effort and collaborations** over long time scales. 

*We have also learned that :* 

 - **subgrid closures are rate controling** components of ocean models; 

 - **numerical discretization is a key** aspect of ocean circulation modelling; 

 - besides the numerical kernel, **interfaces are also important** (forcing function, coupling interfaces, etc...)

 - ocean models are now (arguably) **able to describe mesoscale motions at global scale**;  

 - new frontier :  **submesoscale-permitting modelling at global scale**. 





---
class: left
## Outline of Lecture #2

&nbsp;

&nbsp;

&nbsp;



## Part 1. Resolved versus unresolved physics in ocean circulation models

--

## Part 2. Broadening the spectrum of resolved processes in ocean models

--

## Part 3. Accounting for unresolved processes through subgrid closures

--

## Part 4. Accounting for unresolved processes through model coupling

---
class: center, middle

# Part 1.
# Resolved versus unresolved physics in ocean models

---
class: center
#  Space and time scales of major ocean physical processes

<img style="width:50%"  src="../figures/scales-ocean-processes.jpg" >


Resolving space into regions of dimension $10^{-3}$m for an ocean with volume roughly $1.3 \,10^{18}$ m$^3$ requires $1.3\, 10^{27}$ discrete grid cells (roughly $10^4$ times larger than Avogadro’s number!) (*Griffies*).

**a truncated description of the ocean state is required and will be required in the foreseable future.**



---
class: center
#  Projection of the future evolution of model grid resolution

<img style="width:70%"  src="../figures/FoxKemper.png" >

--

A large fraction of the **spectrum of oceanic variability will remain unresolved** in ocean circulation models in the foreseable future. 

---
class: center
#  Ability of model grids to resolve mesoscale processes


Horizontal resolution needed to resolve the first baroclinic deformation radius with grid points on a mercator grid (Hallberg et al. 2013).

<img style="width:100%"  src="../figures/Hallberg-grid.png" >

--

Actual mesoscale permitting modelling at global scale may require 1/50° horizontal grid resolution...



---
class: left
#  Practical constraints on model grid resolution

&nbsp;

--

 - The overall computational cost of a system is indeed usually constrained by **available computing resources**

--

 - even **more so for operational applications** that ought to deliver near real time products.

--

 - but **grid resolution** of ocean model components of operational systems is also usually set for several years because of the effort required for :

--
 
 	- tuning the physical model configuration, 

--

 	- calibrating the data assimilation components 

--

 	- preparing the downstream data production chains. 

--

- need for a **robust rationale** for designing optimally ocean model components of operational systems 

--

- understanding of **what controls the potential spectrum of resolved process** in ocean circulation models besides the model grid resolution

---
class: center
#  The notion of effective resolution (1/2)

--

.left[
practical **rule of thumb** : 

"*a flow feature is resolved in a ocean model is that there should be no less than $2 \pi$ grid points spanning the feature*" (Griffies and Treguier 2013)
]
--

.left[a more **quantitative approach** :

*effective resolution : the smallest scale that is not significantly affected by numerical dissipation*
]

--

.left-column[
<img style="width:90%"  src="../figures/Skamarock-effective-resolution.png" >
.center[Skamarock et al. (2004)]
]

--

.right-column[

<img style="width:120%"  src="../figures/Soufflet-KE.png" >
.center[Soufflet et al. (2016)]
]

---
class: center
#  The notion of effective resolution (2/2)

<img style="width:80%"  src="../figures/Soufflet-dissipation.png" >

--

The concept of effective resolution is valid for the **high resolution cases** and for **scale selective momentum closures** (Soufflet et al. 2016)

--

under such conditions, typical effective resolution are **about 6 to 10 dx**.

---
class: center, middle

# Part 2. 
# Broadening the spectrum of resolved processes

---
class: left
#  Increasing effective resolution through numerical schemes 

--

 - as discussed above, the usual constraints in ocean model design are related to : **computational resources** and / or **grid resolution**.

--

 - a optimal choice of numerical discretization may allow

--

  - to **use resources more efficiently** and to increase grid resolution 

--

  - to **improve effective resolution** at a given grid resolution

--

 - The notion of **computational efficiency** refers to the **accuracy** of model solution relative to the **computational cost** of numerical integration. 

--

 - The current trend in ocean circulation models is to use **high order discretization schemes** because they usually are more computationaly efficient.


--

 - But **the accuracy and the stability** of model solution are also affected by the ability of ADEs to emulate the properties of the underlying PDEs (**mimetic properties** : conservation of enstrophy/energy, symmetries).

--

&nbsp;
.center[
in practise, need to **trade-off between mimetic prop. and order of accuracy**
]


---
class: left
#  Increasing effective resolution with multiscale modelling 

&nbsp;

 - Multiscale modelling methods, which allow to **locally refine the grid mesh**, are now commonly used in large scale ocean circulation modelling. 

--

- Applications of multiscale approaches in ocean circulation modelling can be classified according to their **grid mesh topology** into : 

--

	- **structured mesh methods** (eg. curvilinear grids), 

.center[
<img style="width:80%"  src="../figures/curv-structured-grid.png" >
]

---
class: left
#  Increasing effective resolution with multiscale modelling 

&nbsp;

 - Multiscale modelling methods, which allow to **locally refine the grid mesh**, are now commonly used in large scale ocean circulation modelling. 

- Applications of multiscale approaches in ocean circulation modelling can be classified according to their **grid mesh topology** into : 

	- **structured mesh methods** (eg. curvilinear grids), 

	- **unstructured mesh methods** (eg. MPAS, FESOM) 

.center[
<img style="width:80%"  src="../figures/unstructured-grid.png" >
]

---
class: left
#  Increasing effective resolution with multiscale modelling 

&nbsp;

 - Multiscale modelling methods, which allow to **locally refine the grid mesh**, are now commonly used in large scale ocean circulation modelling. 

- Applications of multiscale approaches in ocean circulation modelling can be classified according to their **grid mesh topology** into : 

	- **structured mesh methods** (eg. curvilinear grids), 

	- **unstructured mesh methods** (eg. MPAS, FESOM) 

	- **block structured mesh methods** (eg. AGRIF). 


.center[
<img style="width:60%"  src="../figures/block-structured.png" >
]

---
class: left
#  Increasing effective resolution with multiscale modelling 

&nbsp;

 - Multiscale modelling methods, which allow to **locally refine the grid mesh**, are now commonly used in large scale ocean circulation modelling. 

- Applications of multiscale approaches in ocean circulation modelling can be classified according to their **grid mesh topology** into : 

	- **structured mesh methods** (eg. curvilinear grids), 

	- **unstructured mesh methods** (eg. MPAS, FESOM) 

	- **block structured mesh methods** (eg. AGRIF). 

&nbsp;


*Some open issues* : 

- the design of robust **discretization schemes** for large-scale ocean models on triangular or hexagonal meshes is **still challenging** (Danilov 2013). 

- it is still **unclear how to optimally use the potential for mesh refinement** and mesh adaptativity of multiscale modelling approaches in large scale ocean circulation models.


---
class: left
#  Increasing effective resolution with improved usage of HPC

--


.center[
<img style="width:50%"  src="../figures/chip.jpg" >

*And what about using bigger computer for increasing model resolution ?* 

]

--


 - The current trend in HPC is toward **massively parallel machines** with **heterogenous multicore architectures**. 

--

 - Over past decades, **computation have become cheaper** but **memory transfers are still expensive**

--

 - Although modern HPC platforms can deliver a peak **performance in the Petaflop/s range**, most of the existing ocean circulation models are yet **unable to exploit this potential**


---
class: left
#  Increasing effective resolution with improved usage of HPC



 - O(10M) machine now exist (ex : Sunway TaihuLight), but the **scalability of ocean circulation models is curently limited to O(10k) cores** : 

--
 
   - by the **single core** performance of stencil operations (typical of discretized PDEs)

--

   -  by the communication overhead, load imbalance and latency inherent to **spatial domain decomposition** 
 
--

   -  by **memory access** associated with I/O. 

--

*Ways forward ?* : 

--

 - more hybrid parallel programming in order to **exploit more efficiently memory hierarchy** 

--

.left-column[

 -  **innovative algorithms** for solving our PDEs : eg.  parallelisation in time  (eg : Parareal algorithm)

- this will require intense **collaboration between ocean modellers and computer scientists**
]

.right-column[
<img style="width:110%"  src="../figures/Parareal.png" >
]

---
class: center, middle

# Part 3. 
# Accounting for unresolved processes through subgrid scale closures

---
class: left
#  Nonlinearity and subgrid scale closures



Primitive equation (PDEs)
`$$
\large\partial_t \mathbf{s} + \mathcal{L} \,\mathbf{s} + \mathcal{N} (\, \mathbf{s}) = 0$$`

--

Approximated primitive equations (ADEs)

`$$
\large\partial_t \overline{\mathbf{s}} + \mathcal{L} \,\overline{\mathbf{s}} + \mathcal{N} (\, \overline{\mathbf{s}}) = \mathcal{N} (\, \overline{\mathbf{s}}) - \overline{\mathcal{N}(\mathbf{s})} $$`

where : 

 - $\mathbf{s}$ is the ocean state vector

 - $\overline{\mathbf{s}}$ is the resolved state vector

--

The **SGS closure problem** :  estimating a good model $\mathcal{M} (\, \overline{\mathbf{s}}) = \mathcal{N} (\, \overline{\mathbf{s}}) - \overline{\mathcal{N}(\mathbf{s})}$

--

*Caveats* : 

-  it is not that easy to know how to relate  $\mathbf{s}$ and $\overline{\mathbf{s}}$. 

- it is usually assumed that $\overline{\mathbf{s}}$ is an averaged version of $\mathbf{s}$,  but what average ? 

- assuming that $\mathcal{M}$ is deterministic is  strong assumption

---
class: left
#  Approaches to designing subgrid scale closures (1/2)

--

 - $\mathcal{N} (\, \overline{\mathbf{s}}) - \overline{\mathcal{N}(\mathbf{s})}$ contains a lots of terms involving a lot of different correlations among $u,v,w, T, S$

--

 - The general approach is **not to focus on particular nonlinear terms** in the primitive equations but rather on **particular physical processes** (that may affect several terms)

--

 - A rough classification of unresolved physical processes could be : 

  - SGS closures for **balanced turbulence** (eddy closure)
  - SGS closures for **processes in the Ocean Surface Boundary Layer**
  - SGS closures for **interior mixing processes**
  - SGS closures for **Bottom Boundary layer processes**

--

 - the design of SGS closures associated with physical processes usually involves : 

   - idealized process studies with models
   - realistic process studies with models
   - targeted field experiments at sea
   - lab experiments (probably more rarely now)
    
--

 - importantly, a SGS closure should always **target a particular ocean circulation model resolution** because the information at resolved scale depends on the model resolution. 
 

---
class: left
#  Approaches to designing subgrid scale closures (2/2)


&nbsp;

 - Depending the available information from the scales assumled to be resolved in the target model, two categories of closures can be distinguished 
 
--
 
 	-  **RANS-type** (cf Reynolds average), implicitely based on some sort of *ensemble average*, (in practice emulated through time average); example : Gent-McWilliams closure for mesoscale eddy transport
 
--
 
 	-  **LES type** (by analogy to Large Eddy Simulation) implicitely based on some *spatial average*; example : Leith momentum closure
 
--
 
 - LES-type subgrid closures can further be categorized as such 
 
--
 
   - **functional closures** consider the bulk action of the subgrid terms on the resolved scales. example : Smagorinsly momentum closure

--

   - **structural closures** aim at estimating the best local approximation of the unknown SGS term by constructing it from the known structure of small-scale. example : closures defined by Taylor series expansion. 
 


---
class: left
#  Example : the case for eddy energy backscatter (1/2)

.left-column[
<img style="width:100%"  src="../figures/thuburn1.png" >]

.left-column[
&nbsp;

In two-dimensional turbulence, both energy and enstrophy are conserved :   
.center[
<img style="width:70%"  src="../figures/thuburn-eqs.png" >]

&nbsp;


]

 - 

 - remind that in 2D turbulence, **energy is transfered to large scales while enstrophy is transfered to small scale**. 
 
 - so in numerical simulation, **unresolved scale may exchange energy and enstrophy with resolved scales**



---
class: left
#  Example : the case for eddy energy backscatter (2/2)

<img style="width:100%"  src="../figures/thuburn2.png" >

--

 - Thurburn (2013) has made the case for **the need to take into account the backscatter of energy**: 

--

 - showing in particular **biharmonic viscosity is not accounting for this effect**. 

--

 - this has motivated the development of a number of different **closures for primitive equation models** 




---
class: center, middle

# Part 3. 
# Accounting for unresolved processes through model coupling



---
class: left
#  Because, sometimes the best closure is a third party model...


&nbsp;

--

- certains physical processes that are not accounted for in ocean models have received a lot of attention from neighboring scientific community (e.g wave modelling)

--

- it may also happen that it is essential estimating the subgrid state associated with certain unresolved processes require to take into account non-local effects in space and time (eg. propagation and dissipation of internal waves, cf IDEMIX)

--

- it may also make sense to modularize as much as possible a *complex* closure so that it can be used in different models, therefore becoming an independant model perse (eg. CVMIX)

--

- in all the above case, ocean modellers are actually representing missig processes by coupling their ocean circulation models to third party process models.  




---
class: left
#  Example 1: Superparameterization of deep convection. 

<img style="width:90%"  src="../figures/campin2.png" >

Capmpin et al. (2013) have proposed to embed 2Dz non-hydrostatic models with an hydrostatic PE model in order to inprove the representation of the transport due to deep convective plumes. 

---
class: left
#  Example 1: Superparameterization of deep convection. 

<img style="width:90%"  src="../figures/campin4.png" >

Campin et al. (2013)'s approach improves substancially the change in T, S in unstable condition with respect to classical convective adjustment scheme



---
class: left
#  Example 2: Coupling circulation models with wave models. 

Global Distribution of Annual Wave Power Flux from WW3 Model (kW/m)

.center[
<img style="width:70%"  src="../figures/WW3.png" >
]

- surface wave affect OSBL processes in various ways : mixing, langmuir turbulence, air-sea fluxes, stokes drift...

- ocean surface waves are strongly affected by ocean currents;  

- mature surface wave models exist because of the importance of wave forecasting for operations at sea;

- adequately accounting for the impact of surface waves on ocean circulation  in models requires to couple circulation models with wave models

---
class: left
# Side remark : implication for operational centers. 


&nbsp;


--

 - using **coupling** among models for **accounting for unresolved processes** is likely to become more freqeuent as our knowledge of unresolved processes progresses in the future. 

--

 - an other area where this could occur concerns for instance the **representation fine scale atmosphere ocean feedbacks** for submesoscale permitting models. 

--

 - specific **data assimilation methods will be needed** for constraining simultaneously several independant model components in operational systems with data assimilation. 

--

 - more generally, this relates to the **question of the increasing complexity of operational systems** in the future.  
 



---
class: center, middle

# Wrapping-up Lecture #2


---
class: left

# Lecture #2
## Representation of physical processes ocean circulation models

--

 - ocean circulation models are **continuously increasing the range of physical processes** they account for; 

--
 
 -  but defining objectively **what fraction of ocean variability is adequately represented** in ocean model solution is difficult; 

--

 - the **notion of effective resolution** is a simple (simplistic ?) concept that serves as a rationale for separating resolved and unresolved scales in ocean models; 

--

 - Interaction with **computer scientist and applied mathematicians will be essential** to further increasing the range of scale resolved in ocean models (schemes, HPC, ...)


--
 
  - the design of **SGS closures is a key activity** of ocean model design but (1) this is not an easy task (2) the problem is not that well posed (average ?, LES, RANS ? ) 

  
--
 
  - the **coupling with third party models** is likely to become a natural way for ocean circulation model to account for certain classes of physical processes

  
  


   </textarea>
    <!-- This is the link to the local copy of Remark -->
    <script src="../javascript/remark-latest.min.js" type="text/javascript"></script>
    <!--<script src="./javascript/remark-latest.min.js" type="text/javascript"></script>-->
    <!-- See discussion at https://github.com/gnab/remark/issues/222-->
    <!-- You could alternately use the libraries from remote location -->
    <!--<script src="https://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript"></script>-->

    <script type="text/javascript">
        var slideshow = remark.create({
            navigation: {
                click: false
            },
            properties: {
                class: "center, middle"
            },
            countIncrementalSlides: false
        });
    </script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] } });
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML">
    </script>
    <!-- If you want to run your presentation offline, you need to download the MathJax -->
    <!-- libraries, then uncomment the line below and comment out the one above.-->
    <!--<script "text/javascript" src="../../../javascript/MathJax/MathJax.js?config=TeX-AMS_HTML,local/local"></script>-->
</body>
</html>
